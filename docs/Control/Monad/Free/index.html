<!DOCTYPE HTML>
<html><head><link rel="stylesheet" type="text/css" href="../../../style.css"><link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"><title>Control.Monad.Free</title></head><body><div class="navbar navbar-default"><div class="container"><div class="navbar-header"><a class="navbar-brand">Core Libraries</a></div><ul class="nav navbar-nav"><li><a href="../../../index.html">Contents</a></li><li><a href="../../../index/index.html">Index</a></li></ul></div></div><div class="container" id="content"><h1>Control.Monad.Free</h1><a name="Free" href="#Free"><h2><code>Free</code></h2></a><p class="decl"><code><span class="keyword">data</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span></code></p><ul><li><code><span class="ctor">Pure</span> <span class="ident">a</span></code></li><li><code><a href="#Free"><span class="ctor">Free</span></a> <span class="syntax">(</span><span class="ident">f</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span><span class="syntax">)</span></code></li><li><code><span class="ctor">Gosub</span> <span class="syntax">(</span><span class="keyword">forall</span> <span class="ident">s</span><span class="syntax">.</span> <span class="syntax">(</span><span class="keyword">forall</span> <span class="ident">r</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Unit"><span class="ctor">Unit</span></a> <span class="syntax">-&gt;</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">r</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><span class="ident">r</span> <span class="syntax">-&gt;</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">s</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">s</span><span class="syntax">)</span></code></li></ul><p>The free <code>Monad</code> for a <code>Functor</code>.</p>
<p>The implementation defers the evaluation of monadic binds so that it
is safe to use monadic tail recursion, for example.</p>
<a name="FreeC" href="#FreeC"><h2><code>FreeC</code></h2></a><p class="decl"><code><span class="keyword">type</span> <a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="syntax">=</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="syntax">(</span><a href="../../../Data/Coyoneda/index.html#Coyoneda"><span class="ctor">Coyoneda</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p><p>The free <code>Monad</code> for an arbitrary type constructor.</p>
<a name="MonadFree" href="#MonadFree"><h2><code>MonadFree</code></h2></a><p class="decl"><code><span class="keyword">class</span> <a href="#MonadFree"><span class="ctor">MonadFree</span></a> <span class="ident">f</span> <span class="ident">m</span> <span class="keyword">where</span></code></p><ul><li><p class="decl"><code><span class="ident">wrap</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><span class="ident">f</span> <span class="syntax">(</span><span class="ident">m</span> <span class="ident">a</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">a</span></code></p></li></ul><p>The <code>MonadFree</code> class provides the <code>wrap</code> function, which lifts
actions described by a generating functor into a monad.</p>
<p>The canonical instance of <code>MonadFree f</code> is <code>Free f</code>.</p>
<a name="functorFree" href="#functorFree"><h2><code>functorFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">functorFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="applyFree" href="#applyFree"><h2><code>applyFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">applyFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="../../../Prelude/index.html#Apply"><span class="ctor">Apply</span></a> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="applicativeFree" href="#applicativeFree"><h2><code>applicativeFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">applicativeFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="../../../Prelude/index.html#Applicative"><span class="ctor">Applicative</span></a> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="bindFree" href="#bindFree"><h2><code>bindFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">bindFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="../../../Prelude/index.html#Bind"><span class="ctor">Bind</span></a> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="monadFree" href="#monadFree"><h2><code>monadFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="../../../Prelude/index.html#Monad"><span class="ctor">Monad</span></a> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="monadTransFree" href="#monadTransFree"><h2><code>monadTransFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadTransFree</span> <span class="syntax">::</span> <a href="../Trans/index.html#MonadTrans"><span class="ctor">MonadTrans</span></a> <a href="#Free"><span class="ctor">Free</span></a></code></p>
<a name="monadFreeFree" href="#monadFreeFree"><h2><code>monadFreeFree</code></h2></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadFreeFree</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">) =&gt; </span><a href="#MonadFree"><span class="ctor">MonadFree</span></a> <span class="ident">f</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span><span class="syntax">)</span></code></p>
<a name="liftF" href="#liftF"><h2><code>liftF</code></h2></a><p class="decl"><code><span class="ident">liftF</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">m</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">,</span> <a href="../../../Prelude/index.html#Monad"><span class="ctor">Monad</span></a> <span class="ident">m</span><span class="syntax">,</span> <a href="#MonadFree"><span class="ctor">MonadFree</span></a> <span class="ident">f</span> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">a</span></code></p><p>Lift an action described by the generating functor <code>f</code> into the monad <code>m</code>
(usually <code>Free f</code>).</p>

<a name="pureF" href="#pureF"><h2><code>pureF</code></h2></a><p class="decl"><code><span class="ident">pureF</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Applicative"><span class="ctor">Applicative</span></a> <span class="ident">f</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span></code></p><p>An implementation of <code>pure</code> for the <code>Free</code> monad.</p>

<a name="liftFC" href="#liftFC"><h2><code>liftFC</code></h2></a><p class="decl"><code><span class="ident">liftFC</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="ident">a</span></code></p><p>Lift an action described by the generating type constructor <code>f</code> into the monad
<code>FreeC f</code>.</p>

<a name="pureFC" href="#pureFC"><h2><code>pureFC</code></h2></a><p class="decl"><code><span class="ident">pureFC</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Applicative"><span class="ctor">Applicative</span></a> <span class="ident">f</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="ident">a</span></code></p><p>An implementation of <code>pure</code> for the <code>FreeC</code> monad.</p>

<a name="mapF" href="#mapF"><h2><code>mapF</code></h2></a><p class="decl"><code><span class="ident">mapF</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">g</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">,</span> <a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">g</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><a href="../../../Data/Coyoneda/index.html#Natural"><span class="ctor">Natural</span></a> <span class="ident">f</span> <span class="ident">g</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">g</span> <span class="ident">a</span></code></p><p>Use a natural transformation to change the generating functor of a <code>Free</code> monad.</p>

<a name="injC" href="#injC"><h2><code>injC</code></h2></a><p class="decl"><code><span class="ident">injC</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">g</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Data/Inject/index.html#Inject"><span class="ctor">Inject</span></a> <span class="ident">f</span> <span class="ident">g</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">g</span> <span class="ident">a</span></code></p><p>Embed computations in one <code>Free</code> monad as computations in the <code>Free</code> monad for
a coproduct type constructor.</p>
<p>This construction allows us to write computations which are polymorphic in the
particular <code>Free</code> monad we use, allowing us to extend the functionality of
our monad later.</p>

<a name="runFree" href="#runFree"><h2><code>runFree</code></h2></a><p class="decl"><code><span class="ident">runFree</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="syntax">(</span><span class="ident">f</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span></code></p><p><code>runFree</code> runs a computation of type <code>Free f a</code>, using a function which unwraps a single layer of
the functor <code>f</code> at a time.</p>

<a name="runFreeM" href="#runFreeM"><h2><code>runFreeM</code></h2></a><p class="decl"><code><span class="ident">runFreeM</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">m</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../../../Prelude/index.html#Functor"><span class="ctor">Functor</span></a> <span class="ident">f</span><span class="syntax">,</span> <a href="../Rec/Class/index.html#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="syntax">(</span><span class="ident">f</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><a href="#Free"><span class="ctor">Free</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">a</span></code></p><p><code>runFreeM</code> runs a compuation of type <code>Free f a</code> in any <code>Monad</code> which supports tail recursion.
See the <code>MonadRec</code> type class for more details.</p>

<a name="runFreeC" href="#runFreeC"><h2><code>runFreeC</code></h2></a><p class="decl"><code><span class="ident">runFreeC</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><span class="keyword">forall</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span></code></p><p><code>runFreeC</code> is the equivalent of <code>runFree</code> for type constructors transformed with <code>Coyoneda</code>,
hence we have no requirement that <code>f</code> be a <code>Functor</code>.</p>

<a name="runFreeCM" href="#runFreeCM"><h2><code>runFreeCM</code></h2></a><p class="decl"><code><span class="ident">runFreeCM</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">f</span> <span class="ident">m</span> <span class="ident">a</span><span class="syntax">.</span> <span class="syntax">(</span><a href="../Rec/Class/index.html#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><a href="../../../Data/Coyoneda/index.html#Natural"><span class="ctor">Natural</span></a> <span class="ident">f</span> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="syntax">(</span><a href="#FreeC"><span class="ctor">FreeC</span></a> <span class="ident">f</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">a</span></code></p><p><code>runFreeCM</code> is the equivalent of <code>runFreeM</code> for type constructors transformed with <code>Coyoneda</code>,
hence we have no requirement that <code>f</code> be a <code>Functor</code>.</p>

</div></body></html>