<!DOCTYPE HTML>
<html><head><link rel="stylesheet" type="text/css" href="../../../../style.css"><title>Control.Monad.Rec.Class</title></head><body><div id="header"><h1>Control.Monad.Rec.Class</h1></div><a name="MonadRec"></a><p class="decl"><code><span class="keyword">class</span> <span class="syntax">(</span><a href="../../../../Prelude/index.html#Monad"><span class="ctor">Monad</span></a> <span class="ident">m</span><span class="syntax">) &lt;= </span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span></code></p><h3>Type Class Members</h3><div class="typeclass"><p class="decl"><code><span class="ident">tailRecM</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">a</span> <span class="ident">b</span><span class="syntax">.</span> <span class="syntax">(</span><span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="syntax">(</span><a href="../../../../Data/Either/index.html#Either"><span class="ctor">Either</span></a> <span class="ident">a</span> <span class="ident">b</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">b</span></code></p></div><p>This type class captures those monads which support tail recursion in constant stack space.</p>
<p>The <code>tailRecM</code> function takes a step function, and applies that step function recursively
until a return value of type <code>b</code> is found.</p>
<p>Instances are provided for standard monad transformers.</p>
<p>For example:</p>
<pre class="purescript"><code>loopWriter :: Number -&gt; WriterT Sum (Eff (trace :: Trace)) Unit
loopWriter n = tailRecM go n
  where
  go 0 = do
    lift $ trace &quot;Done!&quot;
    return (Right unit)
  go n = do
    tell $ Sum n  
    return (Left (n - 1))
</code></pre>
<a name="tailRecM2"></a><p class="decl"><code><span class="ident">tailRecM2</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">m</span> <span class="ident">a</span> <span class="ident">b</span> <span class="ident">c</span><span class="syntax">.</span> <span class="syntax">(</span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">b</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="syntax">(</span><a href="../../../../Data/Either/index.html#Either"><span class="ctor">Either</span></a> <span class="syntax">{</span> <span class="ident">a</span> <span class="syntax">::</span> <span class="ident">a</span><span class="syntax">,</span> <span class="ident">b</span> <span class="syntax">::</span> <span class="ident">b</span> <span class="syntax">}</span> <span class="ident">c</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">b</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">c</span></code></p><p>Create a tail-recursive function of two arguments which uses constant stack space.</p>

<a name="tailRecM3"></a><p class="decl"><code><span class="ident">tailRecM3</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">m</span> <span class="ident">a</span> <span class="ident">b</span> <span class="ident">c</span> <span class="ident">d</span><span class="syntax">.</span> <span class="syntax">(</span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">b</span> <span class="syntax">-&gt;</span> <span class="ident">c</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="syntax">(</span><a href="../../../../Data/Either/index.html#Either"><span class="ctor">Either</span></a> <span class="syntax">{</span> <span class="ident">a</span> <span class="syntax">::</span> <span class="ident">a</span><span class="syntax">,</span> <span class="ident">b</span> <span class="syntax">::</span> <span class="ident">b</span><span class="syntax">,</span> <span class="ident">c</span> <span class="syntax">::</span> <span class="ident">c</span> <span class="syntax">}</span> <span class="ident">d</span><span class="syntax">)</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">b</span> <span class="syntax">-&gt;</span> <span class="ident">c</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">d</span></code></p><p>Create a tail-recursive function of three arguments which uses constant stack space.</p>

<a name="tailRec"></a><p class="decl"><code><span class="ident">tailRec</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">a</span> <span class="ident">b</span><span class="syntax">.</span> <span class="syntax">(</span><span class="ident">a</span> <span class="syntax">-&gt;</span> <a href="../../../../Data/Either/index.html#Either"><span class="ctor">Either</span></a> <span class="ident">a</span> <span class="ident">b</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">a</span> <span class="syntax">-&gt;</span> <span class="ident">b</span></code></p><p>Create a pure tail-recursive function of one argument</p>
<p>For example:</p>
<pre class="purescript"><code>pow :: Number -&gt; Number -&gt; Number
pow n p = tailRec go { accum: 1, power: p }
  where
  go :: _ -&gt; Either _ Number
  go { accum: acc, power: 0 } = Right acc
  go { accum: acc, power: p } = Left { accum: acc * n, power: p - 1 }
</code></pre>

<a name="monadRecIdentity"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecIdentity</span> <span class="syntax">::</span> <a href="#MonadRec"><span class="ctor">MonadRec</span></a> <a href="../../../../Data/Identity/index.html#Identity"><span class="ctor">Identity</span></a></code></p>
<a name="monadRecEff"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecEff</span> <span class="syntax">::</span> <a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="syntax">(</span><a href="../../Eff/index.html#Eff"><span class="ctor">Eff</span></a> <span class="ident">eff</span><span class="syntax">)</span></code></p>
<a name="monadRecMaybeT"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecMaybeT</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">) =&gt; </span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="syntax">(</span><a href="../../Maybe/Trans/index.html#MaybeT"><span class="ctor">MaybeT</span></a> <span class="ident">m</span><span class="syntax">)</span></code></p>
<a name="monadRecErrorT"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecErrorT</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../Error/index.html#Error"><span class="ctor">Error</span></a> <span class="ident">e</span><span class="syntax">,</span> <a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">) =&gt; </span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="syntax">(</span><a href="../../Error/Trans/index.html#ErrorT"><span class="ctor">ErrorT</span></a> <span class="ident">e</span> <span class="ident">m</span><span class="syntax">)</span></code></p>
<a name="monadRecWriterT"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecWriterT</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="../../../../Data/Monoid/index.html#Monoid"><span class="ctor">Monoid</span></a> <span class="ident">w</span><span class="syntax">,</span> <a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">) =&gt; </span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="syntax">(</span><a href="../../Writer/Trans/index.html#WriterT"><span class="ctor">WriterT</span></a> <span class="ident">w</span> <span class="ident">m</span><span class="syntax">)</span></code></p>
<a name="monadRecStateT"></a><p class="decl"><code><span class="keyword">instance</span> <span class="ident">monadRecStateT</span> <span class="syntax">::</span> <span class="syntax">(</span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">) =&gt; </span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="syntax">(</span><a href="../../State/Trans/index.html#StateT"><span class="ctor">StateT</span></a> <span class="ident">s</span> <span class="ident">m</span><span class="syntax">)</span></code></p>
<a name="forever"></a><p class="decl"><code><span class="ident">forever</span> <span class="syntax">::</span> <span class="keyword">forall</span> <span class="ident">m</span> <span class="ident">a</span> <span class="ident">b</span><span class="syntax">.</span> <span class="syntax">(</span><a href="#MonadRec"><span class="ctor">MonadRec</span></a> <span class="ident">m</span><span class="syntax">)</span> <span class="syntax">=&gt;</span> <span class="syntax">(</span><span class="ident">m</span> <span class="ident">a</span><span class="syntax">)</span> <span class="syntax">-&gt;</span> <span class="ident">m</span> <span class="ident">b</span></code></p><p><code>forever</code> runs an action indefinitely, using the <code>MonadRec</code> instance to
ensure constant stack usage.</p>
<p>For example:</p>
<pre class="purescript"><code>main = forever $ trace &quot;Hello, World!&quot;
</code></pre>

<div id="footer"><small>Generated by psc-pages 0.1.0.0 | <a href="../../../../index.html">Contents</a> | <a href="../../../../index/index.html">Index</a></small></div></body></html>